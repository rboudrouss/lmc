---
import Actu from "@/components/actus/Actu/Actu";
import Layout from "./Layout.astro";

import type { MarkdownLayoutProps } from "astro";
import { parseDateFromString, type ActuT, type AssosName } from "@/helpers";
import Header from "@/components/general/Header.astro";
import Footer from "@/components/general/Footer.astro";

type Props = MarkdownLayoutProps<{
  title: string;
  date?: string;
  img?: string;
  source?: string;
  assos: AssosName[];
  persistant?: boolean;
  url?: string;
}>;

const {
  frontmatter: { title },
  frontmatter,
  compiledContent,
  rawContent,
  url,
} = Astro.props;

const actu: ActuT = {
  title: frontmatter.title,
  date: parseDateFromString(frontmatter.date),
  img: frontmatter.img,
  source: frontmatter.source,
  assos: frontmatter.assos ?? [],
  content: compiledContent(),
  persistant: frontmatter.persistant,
  link: frontmatter.url,
};
---

<Layout
  title={title}
  description={rawContent().trim() !== "" ? rawContent().trim() : undefined}
  image={actu.img}
>
  <Header title={title} url={url} />
  <div class="slot">
    <Actu {...actu} alwaysShow={true} />
  </div>
  <Footer />
</Layout>


<style>
  .slot :global(p) {
    padding: 5px 0;
  }
</style>